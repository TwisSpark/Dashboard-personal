
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Perfil - Sparkavia Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/global/neodark.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/generales/neodark.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/generales/panel.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/generales/perfil.css') }}">
</head>
<body>
    <!-- Navbar -->
    <nav class="dashboard-header">
        <a href="{{ url_for('panel') }}" class="back-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
            </svg>
            Volver al Panel
        </a>
        <h1 class="dashboard-title">Mi Perfil</h1>
        <div class="user-badge">
            <span>{{ info_usuario.usuario }}</span>
        </div>
    </nav>

    <main class="main-content" style="margin-left: 0;">
        <div class="perfil-container">
            <!-- Avatar Section -->
            <div class="avatar-section">
                <div class="avatar-wrapper">
                    {% if info_usuario.avatar %}
                    <img src="{{ info_usuario.avatar }}" alt="Avatar" class="avatar-img" id="avatarPreview">
                    {% else %}
                    <div class="avatar-placeholder" id="avatarPreview">
                        <svg width="80" height="80" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                        </svg>
                    </div>
                    {% endif %}
                    
                    {% if info_usuario.premium %}
                    <div class="premium-badge">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                        PREMIUM
                    </div>
                    {% endif %}
                </div>
                
                <div class="avatar-actions">
                    <label for="avatarInput" class="btn-avatar">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                        </svg>
                        Cambiar Avatar
                    </label>
                    <input type="file" id="avatarInput" accept="image/*" style="display: none;">
                    
                    {% if info_usuario.avatar %}
                    <button class="btn-avatar-delete" id="deleteAvatar">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                        </svg>
                        Eliminar
                    </button>
                    {% endif %}
                </div>
                
                <p class="avatar-hint">Formatos: JPG, PNG, GIF (Máx. 5MB)</p>
            </div>

            <!-- Alerts -->
            {% if error %}
            <div class="alert alert-error">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                </svg>
                {{ error }}
            </div>
            {% endif %}
            
            {% if success %}
            <div class="alert alert-success">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                </svg>
                {{ success }}
            </div>
            {% endif %}

            <div id="avatarMessage" class="mensaje"></div>

            <!-- Form Sections -->
            <div class="perfil-grid">
                <!-- Información Personal -->
                <div class="perfil-card">
                    <h3>Información Personal</h3>
                    <form method="POST" class="perfil-form">
                        <div class="form-group">
                            <label>Nombre de Usuario</label>
                            <input type="text" name="nombre" value="{{ info_usuario.usuario }}" minlength="3" maxlength="20">
                        </div>
                        
                        <div class="form-group">
                            <label>Correo Electrónico</label>
                            <input type="email" name="correo" value="{{ info_usuario.correo }}">
                        </div>
                        
                        <button type="submit" class="btn">Guardar Cambios</button>
                    </form>
                </div>

                <!-- Cambiar Contraseña -->
                <div class="perfil-card">
                    <h3>Cambiar Contraseña</h3>
                    <form method="POST" class="perfil-form">
                        <div class="form-group">
                            <label>Contraseña Actual</label>
                            <input type="password" name="password_actual" placeholder="Ingresa tu contraseña actual">
                        </div>
                        
                        <div class="form-group">
                            <label>Nueva Contraseña</label>
                            <input type="password" name="nueva_password" placeholder="Mínimo 6 caracteres" minlength="6">
                        </div>
                        
                        <div class="form-group">
                            <label>Confirmar Nueva Contraseña</label>
                            <input type="password" name="confirmar_password" placeholder="Repite la nueva contraseña">
                        </div>
                        
                        <button type="submit" class="btn">Actualizar Contraseña</button>
                    </form>
                </div>

                <!-- Info de Cuenta -->
                <div class="perfil-card">
                    <h3>Información de Cuenta</h3>
                    <div class="info-list">
                        <div class="info-item">
                            <span class="info-label">Estado:</span>
                            <span class="info-value">
                                {% if info_usuario.premium %}
                                <span class="badge-premium">✨ Premium</span>
                                {% else %}
                                <span class="badge-free">Gratis</span>
                                {% endif %}
                            </span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Miembro desde:</span>
                            <span class="info-value">{{ info_usuario.fecha_registro[:10] }}</span>
                        </div>
                        {% if not info_usuario.premium %}
                        <a href="{{ url_for('premium') }}" class="btn-upgrade">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                            Actualizar a Premium
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="{{ url_for('static', filename='js/generales/perfil.js') }}"></script>
</body>
</html>